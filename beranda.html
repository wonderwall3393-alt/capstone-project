<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
        integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./style/style.css">
    <link rel="stylesheet" href="./style/responsive.css">
    <link rel="shortcut icon" href="./assets/images/Sphinx_Net_Logo-removebg-preview (1).png" type="image/x-icon">
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />

    <title>Sphinx Net.id</title>
</head>

<body>
    <header>
        <div class="logo-container" id="logoContainer">
            <img src="./assets/images/Sphinx Net Logo.png" alt="logo" height="40">
            <h3>Sphinx <span>Net.</span></h3>
        </div>
        <nav class="navigasi-container" id="navContainer">
            <ul>
                <li><a href="./beranda.html">Beranda</a></li>
                <li><a href="./package.html">Paket</a></li>
                <li><a href="">Informasi</a></li>
                <li><a href="./about.html">Tentang Kita</a></li>
            <div class="button-SU-SI" id="buttonSU_SI">
                <a class="button-login" href="./login.html" id="loginBtn">Sign-in</a>
                <a class="button-signup" href="./signin.html" id="signupBtn">Sign-up</a>
                <div class="user-profile" id="userProfile" style="display: none;">
                    <div class="user-avatar" id="userAvatar">
                        <i class="fa-solid fa-user"></i>
                    </div>
                    <div class="user-dropdown" id="userDropdown">
                        <a href="#profile" id="profileLink">My Profile</a>
                        <a href="#" id="logoutBtn">Logout</a>
                    </div>
                </div>
            </div>
        </nav>
        <label class="box1" id="box1">
            <input type="checkbox" id="menu">
        </label>
    </header>

    <main>
        <section class="hero-section" id="heroSection">
            <div class="hero-content-container">
                <p class="text-hero" id="textHero" data-aos="fade-right">Welcome to Sphinx Net.</p>
                <h1 class="head-hero" data-aos="fade-right">Enjoy Your <br>Fast Internet</h1>
                <div class="lm-button-container" data-aos="fade-right">
                    <a class="lm-button" href="">Learn more</a>
                </div>
            </div>
        </section>

        <section class="package-section">
            <div class="package-content-container">
                <h1 class="head-package" data-aos="fade-up">Subscribe to a package</h1>
                <p class="text-package" data-aos="fade-up">Choose from our wide range of internet and data packages
                    designed for every
                    lifestyle. Enjoy seamless browsing, faster downloads, and unbeatable coverage â€” all at the best
                    prices.
                </p>
                <div class="choice-package">
                    <a class="package1" href="" data-aos="fade-up"><i class="fa-solid fa-sim-card"></i><br>sim
                        credit<br>package</a>
                    <a class="package2" href="" data-aos="fade-up"><i
                            class="fa-solid fa-wifi"></i><br>wifi<br>package</a>
                    <a class="package3" href="" data-aos="fade-up"><i
                            class="fa-solid fa-signal"></i><br>quota<br>package</a>
                </div>
            </div>
        </section>

    <!-- Recommendation Section -->
    <section class="recommendation-section" id="recommendationSection">
        <div class="recommendation-header">
            <h2>For You</h2>
            <div class="header-line"></div>
            <button class="survey-button" id="surveyBtn">Survey Pengguna</button>
        </div>

        <!-- Recommendations Container -->
        <div class="recommendations-container" id="recommendationsContainer">
            <div class="recommendation-cards" id="recommendationCards">
                <!-- Cards will be dynamically inserted here -->
            </div>
            <div class="retake-survey">
                <button class="btn-retake" id="retakeBtn">Retake Survey</button>
            </div>
        </div>
    </section>

    <!-- Survey Modal -->
    <div class="survey-modal" id="surveyModal">
        <div class="survey-content">
            <div id="surveyQuestions">
                <!-- Questions will be dynamically inserted here -->
            </div>
            <div class="survey-buttons">
                <button class="btn-prev" id="btnPrev" disabled>Previous</button>
                <button class="btn-next" id="btnNext">Next</button>
                <button class="btn-submit" id="btnSubmit" style="display: none;">Submit</button>
            </div>
        </div>
    </div>

    <script>
        // Data Paket Internet
        const packages = [
            { name: "Sphinx Stable 20GB", kuota: "20GB", harga: 40000, category: "stable" },
            { name: "Sphinx Stable 50GB", kuota: "50GB", harga: 75000, category: "stable" },
            { name: "Sphinx Stable 100GB", kuota: "100GB", harga: 120000, category: "stable" },
            { name: "Sphinx Hemat 5GB", kuota: "5GB", harga: 25000, category: "hemat" },
            { name: "Sphinx Hemat 10GB", kuota: "10GB", harga: 35000, category: "hemat" },
            { name: "Sphinx Hemat 20GB", kuota: "20GB", harga: 45000, category: "hemat" },
            { name: "Sphinx Hemat 30GB", kuota: "30GB", harga: 55000, category: "hemat" },
            { name: "Sphinx Unlimited", kuota: "Unlimited", harga: 250000, category: "unlimited" },
            { name: "Sphinx Call Pro", kuota: "300 Menit", harga: 50000, category: "call" },
            { name: "Sphinx Call Flex", kuota: "150 Menit", harga: 30000, category: "call" },
            { name: "Sphinx Call Lite", kuota: "60 Menit", harga: 15000, category: "call" },
            { name: "Sphinx Social 10GB", kuota: "10GB", harga: 20000, category: "social" },
            { name: "Sphinx Stream 50GB", kuota: "50GB", harga: 70000, category: "stream" },
            { name: "Sphinx Stream 100GB", kuota: "100GB", harga: 120000, category: "stream" },
            { name: "Sphinx Work Connect 30GB", kuota: "30GB", harga: 55000, category: "work" },
            { name: "Sphinx Gamer Pro 40GB", kuota: "40GB", harga: 65000, category: "gaming" },
            { name: "Sphinx Gamer Max 80GB", kuota: "80GB", harga: 110000, category: "gaming" },
            { name: "Sphinx IoT Home 20GB", kuota: "20GB", harga: 30000, category: "iot" },
            { name: "Sphinx IoT Fiber 30 Mbps", kuota: "Fiber IoT", harga: 150000, category: "iot" },
            { name: "Sphinx Global Lite", kuota: "1GB", harga: 75000, category: "roaming" },
            { name: "Sphinx Global Pass", kuota: "3GB", harga: 150000, category: "roaming" },
            { name: "Sphinx Roam Max", kuota: "10GB", harga: 350000, category: "roaming" }
        ];

        // Survey Questions
        const surveyQuestions = [
            {
                id: "phone_model",
                question: "Handphone apa yang Anda pakai?",
                type: "radio",
                options: [
                    "iPhone (13/14/15 Pro Max)",
                    "iPhone (12/13/14)",
                    "iPhone (11/XS/XR)",
                    "Samsung Galaxy S Series",
                    "Samsung Galaxy A Series",
                    "OPPO Reno/Find Series",
                    "Xiaomi Redmi Note Series",
                    "Xiaomi Mi/Poco Series",
                    "Vivo V/S Series",
                    "Realme GT/Pro Series",
                    "Lainnya"
                ]
            },
            {
                id: "gender",
                question: "Apa jenis kelamin anda?",
                type: "radio",
                options: ["Laki-laki", "Perempuan"]
            },
            {
                id: "reason",
                question: "Apa alasan Anda memilih produk ini?",
                type: "radio",
                options: ["Mencari internet yang stabil", "Mencari internet yang murah", "Mencari paket unlimited"]
            },
            {
                id: "call_frequency",
                question: "Seberapa sering Anda menggunakan paket telepon?",
                type: "radio",
                options: ["Tidak pernah", "Jarang", "Kadang", "Sering"]
            },
            {
                id: "wifi",
                question: "Apakah anda memiliki wifi?",
                type: "radio",
                options: ["Ya dirumah", "Ya di kantor", "Tidak"]
            },
            {
                id: "housing",
                question: "Apa jenis hunian Anda?",
                type: "radio",
                options: ["Rumah pribadi", "Apartemen", "Kost/kontrakan"]
            },
            {
                id: "usage",
                question: "Untuk keperluan apa Anda menggunakan internet? (boleh pilih lebih dari satu)",
                type: "checkbox",
                options: [
                    "Browsing & media sosial",
                    "Streaming video (YouTube, Netflix, dll.)",
                    "Video conference (Zoom, Teams, dll.)",
                    "Gaming online",
                    "Smart home / IoT"
                ]
            },
            {
                id: "quota",
                question: "Berapa estimasi penggunaan kuota internet per bulan?",
                type: "radio",
                options: ["< 10 GB", "10-25 GB", "25-50 GB", "50â€“100 GB", "100â€“300 GB", "> 300 GB / unlimited"]
            },
            {
                id: "budget",
                question: "Berapa anggaran bulanan Anda untuk internet?",
                type: "radio",
                options: ["< Rp25.000", "Rp25.000â€“Rp50.000", "Rp.50.000-Rp100.000", "Rp.100.000â€“Rp250.000", "> Rp250.000"]
            },
            {
                id: "preference",
                question: "Anda lebih suka jenis paket:",
                type: "radio",
                options: ["Unlimited", "Kuota besar", "Hemat/entry-level", "Paket bundling TV/telepon"]
            },
            {
                id: "roaming",
                question: "Apakah anda sering pergi ke luar negeri?",
                type: "radio",
                options: ["Tidak", "Jarang", "Kadang", "Sering"]
            }
        ];

        // State
        let currentQuestion = 0;
        let surveyAnswers = {};

        // Elements
        const surveyBtn = document.getElementById('surveyBtn');
        const surveyModal = document.getElementById('surveyModal');
        const surveyQuestionsContainer = document.getElementById('surveyQuestions');
        const btnPrev = document.getElementById('btnPrev');
        const btnNext = document.getElementById('btnNext');
        const btnSubmit = document.getElementById('btnSubmit');
        const recommendationsContainer = document.getElementById('recommendationsContainer');
        const recommendationCards = document.getElementById('recommendationCards');
        const retakeBtn = document.getElementById('retakeBtn');

        // Initialize Survey
        function initSurvey() {
            surveyQuestionsContainer.innerHTML = '';
            surveyQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'survey-question';
                if (index === 0) questionDiv.classList.add('active');

                let optionsHTML = '';
                q.options.forEach((option, optIndex) => {
                    const inputType = q.type;
                    const inputName = q.id;
                    const inputId = `${q.id}_${optIndex}`;
                    optionsHTML += `
                        <label class="option-label" for="${inputId}">
                            <input type="${inputType}" name="${inputName}" id="${inputId}" value="${option}">
                            <span>${option}</span>
                        </label>
                    `;
                });

                questionDiv.innerHTML = `
                    <div class="question-number">Pertanyaan ${index + 1} dari ${surveyQuestions.length}</div>
                    <div class="question-title">${q.question}</div>
                    <div class="options-container">
                        ${optionsHTML}
                    </div>
                `;

                surveyQuestionsContainer.appendChild(questionDiv);
            });

            // Add event listeners for option selection
            document.querySelectorAll('.option-label input').forEach(input => {
                input.addEventListener('change', function() {
                    if (this.type === 'radio') {
                        document.querySelectorAll(`input[name="${this.name}"]`).forEach(radio => {
                            radio.closest('.option-label').classList.remove('selected');
                        });
                    }
                    if (this.checked) {
                        this.closest('.option-label').classList.add('selected');
                    } else {
                        this.closest('.option-label').classList.remove('selected');
                    }
                });
            });
        }

        // Show Survey Modal
        surveyBtn.addEventListener('click', () => {
            surveyModal.classList.add('active');
            currentQuestion = 0;
            surveyAnswers = {};
            initSurvey();
            updateButtons();
        });

        // Close modal when clicking outside
        surveyModal.addEventListener('click', (e) => {
            if (e.target === surveyModal) {
                surveyModal.classList.remove('active');
            }
        });

        // Navigation
        btnPrev.addEventListener('click', () => {
            if (currentQuestion > 0) {
                saveCurrentAnswer();
                currentQuestion--;
                showQuestion(currentQuestion);
                updateButtons();
            }
        });

        btnNext.addEventListener('click', () => {
            if (validateCurrentQuestion()) {
                saveCurrentAnswer();
                currentQuestion++;
                showQuestion(currentQuestion);
                updateButtons();
            } else {
                alert('Silakan pilih minimal satu jawaban');
            }
        });

        btnSubmit.addEventListener('click', () => {
            if (validateCurrentQuestion()) {
                saveCurrentAnswer();
                calculateRecommendations();
                surveyModal.classList.remove('active');
                showRecommendations();
            } else {
                alert('Silakan pilih minimal satu jawaban');
            }
        });

        retakeBtn.addEventListener('click', () => {
            surveyBtn.click();
        });

        function showQuestion(index) {
            const questions = document.querySelectorAll('.survey-question');
            questions.forEach((q, i) => {
                q.classList.remove('active');
                if (i === index) {
                    q.classList.add('active');
                }
            });
        }

        function updateButtons() {
            btnPrev.disabled = currentQuestion === 0;
            
            if (currentQuestion === surveyQuestions.length - 1) {
                btnNext.style.display = 'none';
                btnSubmit.style.display = 'block';
            } else {
                btnNext.style.display = 'block';
                btnSubmit.style.display = 'none';
            }
        }

        function validateCurrentQuestion() {
            const currentQ = surveyQuestions[currentQuestion];
            const inputs = document.querySelectorAll(`input[name="${currentQ.id}"]:checked`);
            return inputs.length > 0;
        }

        function saveCurrentAnswer() {
            const currentQ = surveyQuestions[currentQuestion];
            if (currentQ.type === 'checkbox') {
                const checked = Array.from(document.querySelectorAll(`input[name="${currentQ.id}"]:checked`))
                    .map(input => input.value);
                surveyAnswers[currentQ.id] = checked;
            } else {
                const checked = document.querySelector(`input[name="${currentQ.id}"]:checked`);
                if (checked) {
                    surveyAnswers[currentQ.id] = checked.value;
                }
            }
        }

        // Recommendation Logic
        function calculateRecommendations() {
            const weights = {
                usage: 0.30,
                budget: 0.25,
                need: 0.20,
                preference: 0.15,
                call: 0.10,
                roaming: 0.10
            };

            const scores = packages.map(pkg => {
                let score = 0;

                // Usage Match (0.30)
                score += calculateUsageMatch(pkg) * weights.usage;

                // Budget Fit (0.25)
                score += calculateBudgetFit(pkg) * weights.budget;

                // Need Match (0.20)
                score += calculateNeedMatch(pkg) * weights.need;

                // Preference Match (0.15)
                score += calculatePreferenceMatch(pkg) * weights.preference;

                // Call Frequency (0.10)
                score += calculateCallMatch(pkg) * weights.call;

                // Roaming (0.10)
                score += calculateRoamingMatch(pkg) * weights.roaming;

                return { ...pkg, score: score };
            });

            // Sort by score and get top 6
            const topRecommendations = scores
                .sort((a, b) => b.score - a.score)
                .filter(pkg => pkg.score > 0)
                .slice(0, 6);

            displayRecommendations(topRecommendations);
        }

        function calculateUsageMatch(pkg) {
            const usage = surveyAnswers.usage || [];
            let match = 0;

            if (usage.includes('Browsing & media sosial')) {
                if (['social', 'hemat', 'stable'].includes(pkg.category)) match = 1;
            }
            if (usage.includes('Streaming video (YouTube, Netflix, dll.)')) {
                if (pkg.category === 'stream' || pkg.name.includes('Stream') || pkg.name.includes('Stable 50GB')) match = 1;
            }
            if (usage.includes('Video conference (Zoom, Teams, dll.)')) {
                if (pkg.category === 'work' || pkg.category === 'stable') match = 1;
            }
            if (usage.includes('Gaming online')) {
                if (pkg.category === 'gaming') match = 1;
            }
            if (usage.includes('Smart home / IoT')) {
                if (pkg.category === 'iot') match = 1;
            }

            return match;
        }

        function calculateBudgetFit(pkg) {
            const budgetMap = {
                "< Rp25.000": 25000,
                "Rp25.000â€“Rp50.000": 50000,
                "Rp.50.000-Rp100.000": 100000,
                "Rp.100.000â€“Rp250.000": 250000,
                "> Rp250.000": 500000
            };

            const userBudget = budgetMap[surveyAnswers.budget] || 100000;
            
            if (pkg.harga > userBudget) {
                const over = (pkg.harga - userBudget) / userBudget;
                return Math.max(0, 1 - over);
            }
            return 1;
        }

        function calculateNeedMatch(pkg) {
            const reason = surveyAnswers.reason;
            
            if (reason === "Mencari internet yang stabil" && pkg.category === "stable") return 1;
            if (reason === "Mencari internet yang murah" && pkg.category === "hemat") return 1;
            if (reason === "Mencari paket unlimited" && pkg.category === "unlimited") return 1;
            
            return 0;
        }

        function calculatePreferenceMatch(pkg) {
            const pref = surveyAnswers.preference;
            
            if (pref === "Unlimited" && pkg.category === "unlimited") return 1;
            if (pref === "Kuota besar" && (pkg.kuota.includes('50GB') || pkg.kuota.includes('100GB') || pkg.kuota.includes('80GB'))) return 1;
            if (pref === "Hemat/entry-level" && pkg.category === "hemat") return 1;
            if (pref === "Paket bundling TV/telepon" && pkg.category === "call") return 1;
            
            return 0.5;
        }

        function calculateCallMatch(pkg) {
            const callFreq = surveyAnswers.call_frequency?.toLowerCase() || "tidak pernah";
            
            if (pkg.category !== 'call') return 0;
            
            if (callFreq === "tidak pernah") return 0;
            if (callFreq === "jarang") return 0.3;
            if (callFreq === "kadang") return 0.6;
            if (callFreq === "sering") return 1;
            
            return 0;
        }

        function calculateRoamingMatch(pkg) {
            const roaming = surveyAnswers.roaming?.toLowerCase() || "tidak";
            
            if (pkg.category !== 'roaming') return 0;
            
            if (roaming === "tidak") return 0;
            if (roaming === "jarang") return 0.3;
            if (roaming === "kadang") return 0.6;
            if (roaming === "sering") return 1;
            
            return 0;
        }

        function displayRecommendations(recommendations, metadata = null) {
            recommendationCards.innerHTML = '';

            if (!recommendations || recommendations.length === 0) {
                recommendationCards.innerHTML = '<div class="no-recommendations">Tidak ada rekomendasi yang sesuai. Silakan coba lagi dengan jawaban berbeda.</div>';
                return;
            }

            // Count AI Model and Survey recommendations
            const aiCount = recommendations.filter(pkg => pkg.recommendation_type === 'ml_model').length;
            const surveyCount = recommendations.filter(pkg => pkg.recommendation_type === 'survey_based').length;

            // Add header showing recommendation types
            const headerDiv = document.createElement('div');
            headerDiv.className = 'recommendation-header';
            headerDiv.innerHTML = `
                <h2>ðŸŽ¯ Rekomendasi Untuk Anda</h2>
                <div class="recommendation-stats">
                    <div class="stat-item ai-stat">
                        <i class="fa-solid fa-brain"></i>
                        <span>AI Model: ${aiCount} paket</span>
                    </div>
                    <div class="stat-item survey-stat">
                        <i class="fa-solid fa-user-poll"></i>
                        <span>Survey Analysis: ${surveyCount} paket</span>
                    </div>
                </div>
                <div class="recommendation-subtitle">Total ${recommendations.length} rekomendasi ditemukan</div>
            `;
            recommendationCards.appendChild(headerDiv);

            // Create recommendation cards container
            const cardsContainer = document.createElement('div');
            cardsContainer.className = 'recommendation-cards';

            // Add all recommendation cards with clear labels
            recommendations.forEach(pkg => {
                const isAI = pkg.recommendation_type === 'ml_model';
                const matchPercentage = pkg.match_percentage || Math.round((pkg.score || 0) * 100);

                const cardHTML = createHybridRecommendationCard(pkg, isAI, matchPercentage);
                cardsContainer.innerHTML += cardHTML;
            });

            recommendationCards.appendChild(cardsContainer);
        }

        function createHybridRecommendationCard(pkg, isAI, matchPercentage) {
            const sourceText = isAI ? 'AI Model' : 'Survey Analysis';
            const sourceIcon = isAI ? 'fa-brain' : 'fa-user-poll';
            const sourceClass = isAI ? 'ai-card' : 'survey-card';
            const labelClass = isAI ? 'ai-label' : 'survey-label';

            return `<div class="package-card ${sourceClass}">
                    <div class="recommendation-label ${labelClass}">
                        <i class="fa-solid ${sourceIcon}"></i>
                        ${sourceText}
                    </div>
                    <div class="match-score">
                        <i class="fa-solid fa-percentage"></i>
                        Match: ${matchPercentage}%
                    </div>
                    ${pkg.source ? `<div class="recommendation-source">
                        <i class="fa-solid fa-info-circle"></i>
                        ${pkg.source}
                    </div>` : ''}
                    <div class="package-name">${pkg.name}</div>
                    <div class="package-details">${pkg.kuota}</div>
                    <div class="package-category">${pkg.category.charAt(0).toUpperCase() + pkg.category.slice(1)}</div>
                    <div class="package-price">Rp ${pkg.harga.toLocaleString('id-ID')}</div>
                    <button class="btn-choose ${isAI ? 'ai-choose' : 'survey-choose'}">
                        <i class="fa-solid fa-check"></i>
                        Pilih Paket
                    </button>
                </div>`;
        }

        
        function showRecommendations() {
            recommendationsContainer.classList.add('active');
            surveyBtn.textContent = 'Retake Survey';
        }

        // Authentication State Management
        let currentUser = null;

        function checkAuthState() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showUserProfile();
            } else {
                showLoginButtons();
            }
        }

        function showUserProfile() {
            const loginBtn = document.getElementById('loginBtn');
            const signupBtn = document.getElementById('signupBtn');
            const userProfile = document.getElementById('userProfile');

            loginBtn.style.display = 'none';
            signupBtn.style.display = 'none';
            userProfile.style.display = 'flex';

            // Update user avatar with initial
            const userAvatar = document.getElementById('userAvatar');
            userAvatar.innerHTML = currentUser.name.charAt(0).toUpperCase();
        }

        function showLoginButtons() {
            const loginBtn = document.getElementById('loginBtn');
            const signupBtn = document.getElementById('signupBtn');
            const userProfile = document.getElementById('userProfile');

            loginBtn.style.display = 'block';
            signupBtn.style.display = 'block';
            userProfile.style.display = 'none';
        }

        function logout() {
            localStorage.removeItem('currentUser');
            currentUser = null;
            showLoginButtons();
            alert('Anda telah berhasil logout');
        }

        // Event Listeners for Authentication
        document.getElementById('logoutBtn').addEventListener('click', logout);

        document.getElementById('profileLink').addEventListener('click', (e) => {
            e.preventDefault();
            if (currentUser) {
                showUserProfileModal();
            }
        });

        function showUserProfileModal() {
            // Create user profile modal
            const modal = document.createElement('div');
            modal.className = 'user-modal';
            modal.innerHTML = `
                <div class="user-modal-content">
                    <div class="user-modal-header">
                        <h2>User Profile</h2>
                        <button class="close-modal" onclick="this.closest('.user-modal').remove()">
                            <i class="fa-solid fa-times"></i>
                        </button>
                    </div>
                    <div class="user-profile-info">
                        <div class="profile-avatar">${currentUser.name.charAt(0).toUpperCase()}</div>
                        <div class="profile-details">
                            <h3>${currentUser.name}</h3>
                            <p>${currentUser.email}</p>
                            <p><strong>ID Pelanggan:</strong> ${currentUser.id || 'ID' + Math.random().toString(36).substr(2, 9)}</p>
                        </div>
                    </div>

                    <div class="package-status">
                        <h4>Paket Aktif</h4>
                        <div class="active-package">
                            <div class="package-info">
                                <h5>${currentUser.package || 'Sphinx Stable 20GB'}</h5>
                                <p>Kuota: <span id="quotaUsed">15</span>GB / <span id="quotaTotal">20</span>GB</p>
                            </div>
                            <div class="data-usage-chart">
                                <div class="pie-chart" id="pieChart" style="background: conic-gradient(
                                    #4CAF50 0% 75%,  /* 75% Terpakai */
                                    #ddd 75% 100%    /* 25% Sisa */
                                );"></div>
                                <div class="chart-legend">
                                    <span class="legend-item">
                                        <span class="legend-color" style="background: #4CAF50;"></span>
                                        Terpakai
                                    </span>
                                    <span class="legend-item">
                                        <span class="legend-color" style="background: #ddd;"></span>
                                        Sisa
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Survey integration with AI Model + Survey Analysis
        async function sendSurveyToPython(surveyData) {
            // Store locally for backup
            localStorage.setItem('surveyData', JSON.stringify(surveyData));

            try {
                const response = await fetch('http://localhost:8000/api/recommend', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(surveyData)
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        console.log('ðŸ“Š Hybrid recommendations received:', result.metadata);
                        return result;
                    }
                } else {
                    throw new Error('Server error');
                }
            } catch (error) {
                console.log('ðŸ¤– AI Model server not available, using frontend calculation');
                return null; // Fallback to frontend calculation
            }

            return null;
        }

        // Enhanced survey submission
        btnSubmit.addEventListener('click', async () => {
            if (validateCurrentQuestion()) {
                saveCurrentAnswer();

                // Add phone model data to survey
                surveyAnswers.phone_model = document.querySelector('input[name="phone_model"]:checked')?.value;

                // Show loading state
                btnSubmit.disabled = true;
                btnSubmit.textContent = 'Processing...';

                try {
                    // Send data to Python backend
                    const backendResult = await sendSurveyToPython(surveyAnswers);

                    if (backendResult) {
                        displayRecommendations(backendResult.recommendations, backendResult.metadata);
                    } else {
                        // Fallback to frontend calculation
                        calculateRecommendations();
                    }
                } catch (error) {
                    console.error('Error processing recommendations:', error);
                    // Fallback to frontend calculation
                    calculateRecommendations();
                } finally {
                    btnSubmit.disabled = false;
                    btnSubmit.textContent = 'Submit';
                    surveyModal.classList.remove('active');
                    showRecommendations();
                }
            } else {
                alert('Silakan pilih minimal satu jawaban');
            }
        });

        // Initialize
        initSurvey();
        checkAuthState();
    </script>

        <section class="quotes-section">
            <div class="quotes-content-container">
                <div class="img-container">
                    <div class="img1" data-aos="fade-upt"></div>
                    <div class="img2" data-aos="fade-up"></div>
                </div>
                <div class="text-quotes-container" data-aos="fade-up">
                    <h1 class="head-quotes">"We make<br>everything<br>simple and<br>fast."</h1>
                    <p class="text-quotes">Let's get a little closer â€” <br>here's who we are and what we <br>love to do.
                    </p>
                    <div class="about-button-container">
                        <a class="about-button" href="">About us</a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-container">
            <div class="footer-logo-container">
                <img src="./assets/images/Sphinx_Net_Logo-removebg-preview (1).png" alt="logo" height="150">
                <h2 class="text-logo">Sphinx <span class="span1">Net.</span></h2>
            </div>
            <div class="footer-content-container">
                <div class="footer-list">
                    <div class="list1">
                        <p>Package & Price</p>
                        <ul>
                            <li><a href="">sim credit package</a></li>
                            <li><a href="">wifi package</a></li>
                            <li><a href="">quota package</a></li>
                        </ul>
                    </div>
                    <div class="list2">
                        <p>Service</p>
                        <ul>
                            <li><a href="">sign-up</a></li>
                            <li><a href="">contact us</a></li>
                            <li><a href="">about us</a></li>
                        </ul>
                    </div>
                    <div class="list3">
                        <p>Infomation</p>
                        <ul>
                            <li><a href="">promo</a></li>
                            <li><a href="">news</a></li>
                            <li><a href="">FAQ</a></li>
                            <li><a href="">terms & conditions</a></li>
                        </ul>
                    </div>
                </div>
                <div class="lisence">
                    <p>Jl. Raya Siman, Dusun I, Demangan,<br> Kec. Siman, Kabupaten Ponorogo, <br>Jawa Timur 63471</p>
                    <p>Â© 2025 Sphinx Net. All Rights Reserved.</p>
                    <div class="up-button">
                        <a href="#heroSection"><i class="fa-solid fa-chevron-up"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <script>
        feather.replace();
    </script>
    <script src="./script/animation.js"></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
        AOS.init();
    </script>
</body>

</html>